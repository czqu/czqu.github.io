<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name="description" content="内容介绍
"><meta name="keywords" content="czq's Blog,  博客, 个人网站, 互联网, java,Linux,Web"><meta name="theme-color" content="#000000"><meta property="og:title" content="h5别踩白块游戏 - Czq's Blog"><meta property="og:type" content="article"><meta property="og:description" content="内容介绍
"><meta property="article:published_time" content="2020-11-05T23:01:00Z"><meta property="article:author" content="czq"><meta property="article:tag" content="前端"><meta property="og:image" content="https://czqu.cc/img/avatar-boy.webp"><meta property="og:url" content="https://czqu.cc/Do-not-Tap-The-White-Tile.html"><meta property="og:site_name" content="Czq's Blog"><title>h5别踩白块游戏 - Czq's Blog</title><link rel="manifest" href="/pwa/manifest.json"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://czqu.cc/Do-not-Tap-The-White-Tile.html"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/hux-blog.min.css"><link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><script></script></head><body ontouchstart=""><script src="/js/qin-blog.js" type="text/javascript"></script><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class="container-fluid"><div class="navbar-header page-scroll"><button type="button" class="navbar-toggle"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">Czq's Blog</a></div><div id="huxblog_navbar"><div class="navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/archive/">Archive</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse"),__HuxNav__={close:function(){$navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)},open:function(){$collapse.style.height="auto",$navbar.className+=" in"}};$toggle.addEventListener("click",function(e){0<$navbar.className.indexOf("in")?__HuxNav__.close():__HuxNav__.open()}),document.addEventListener("click",function(e){e.target!=$toggle&&"icon-bar"!=e.target.className&&__HuxNav__.close()})</script><style type="text/css">header.intro-header{position:relative;background-image:url(/img/home-bg-notdimmed.webp)}</style><header class="intro-header"><div class="header-mask"></div><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><div class="tags"><a class="tag" href="/archive/?tag=%E5%89%8D%E7%AB%AF" title="前端">前端</a></div><h1>h5别踩白块游戏</h1><h2 class="subheading"></h2><span class="meta">Posted by czq on November 5, 2020</span></div></div></div></div></header><article><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container"><h1 id="内容介绍">内容介绍</h1><h4 id="1简介">1.简介</h4><p>别踩白块这个游戏相信很多人都在手机上玩过，今天我们就来做一个网页版的，先上一张游戏效果图：</p><p><img src="../img/in-post/2020-11-5-Do-not-Tap-The-White-Tile/uid1133717-20191017-1571296275564" alt="图片描述"></p><p>属于简化版别踩白块，代码相对较为简单易学，主要涉及通过 javascript 操作元素节点的增删以及属性节点（class）的操作。</p><h4 id="2知识点">2.知识点</h4><ul><li>HTML/CSS</li><li>JavaScript</li><li>元素节点增删</li><li>属性节点操作</li></ul><h4 id="3项目架构">3.项目架构</h4><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>puzzle
   |index.html
   |css/index.css
   |js/index.js
</pre></td></tr></tbody></table></code></pre></div></div><h1 id="项目原理">项目原理</h1><p>在开始编程之前，让我们先来分析下整个游戏的流程：一定的速度下移，点击黑块，黑块消失，新的黑块出现在普通游戏玩家眼中，应该是游戏开始，黑块不断向下移动，若黑块触底则游戏结束；</p><p>而以开发者来说，<strong>应将每一个黑块和白块抽象成一个个的数据结构，黑块的消失和出现其实就是数据结构的创造和销毁</strong>，我们来看一张游戏的流程图，对于要编写的功能有一个大概的了解:</p><p><img src="../img/in-post/2020-11-5-Do-not-Tap-The-White-Tile/image-20201105153016423.png" alt="image-20201105153016423"></p><h1 id="实现步骤">实现步骤</h1><h4 id="页面布局">页面布局</h4><p>可以用 div+css 布局来实现别踩白块的静态效果展示，直接上 HTML 代码，我来简要说下 HTML 思路，将主界面分解成一个 4x4 的大矩形格子，每一个方块代表其中一个小的矩形格，其中每一行的四个白块中有一个黑块，每一行中黑块位于哪一列是随机生成的，但是我们这里现在是静态页面就自己确定了，然后通过 css 控制样式。</p><p>创建 index.html 文件，并输入以下代码：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;title&gt;</span>别踩白块<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/index.css"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"main"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"con"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
          /*白块*/
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell black"</span><span class="nt">&gt;&lt;/div&gt;</span>
          /*黑块*/
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell black"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell black"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell black"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/index.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div><h4 id="添加样式">添加样式</h4><p>下面是 css 代码，这里有一个要注意的地方，我将 <code class="language-plaintext highlighter-rouge">div#con</code> 块级元素向上提了 100 px，这样在游戏的开始就出现了最底一行的空白，隐藏最上面那行，为什么要这样呢，继续往下看就知道了。设置黑白块的样式，为 js 部分动态插入黑白块做准备。</p><p>创建 <code class="language-plaintext highlighter-rouge">css/index.css</code> 文件，并输入以下代码：</p><div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="nf">#main</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">408px</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">408px</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">2px</span> <span class="nb">solid</span> <span class="no">gray</span><span class="p">;</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="nb">auto</span><span class="p">;</span>
  <span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">h2</span> <span class="p">{</span>
  <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#con</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">400px</span><span class="p">;</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
  <span class="nl">top</span><span class="p">:</span> <span class="m">-408px</span><span class="p">;</span> <span class="c">/*隐藏所有格子*/</span>
  <span class="nl">border-collapse</span><span class="p">:</span> <span class="nb">collapse</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* 行 */</span>
<span class="nc">.row</span> <span class="p">{</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* 一个块 */</span>
<span class="nc">.cell</span> <span class="p">{</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span>
  <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="nb">rgb</span><span class="p">(</span><span class="m">54</span><span class="p">,</span> <span class="m">74</span><span class="p">,</span> <span class="m">129</span><span class="p">)</span> <span class="m">1px</span> <span class="nb">solid</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.black</span> <span class="p">{</span>
  <span class="nl">background</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.btn</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.start</span> <span class="p">{</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="m">20px</span> <span class="nb">auto</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">150px</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">50px</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="no">yellowgreen</span><span class="p">;</span>
  <span class="nl">line-height</span><span class="p">:</span> <span class="m">50px</span><span class="p">;</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>如果以上部分你都能够理解并且对应着代码实现的话，那么我们看到的应该是一个空格子，我们设置 id 为 con 的 div 的 top 属性为 0 px: <code class="language-plaintext highlighter-rouge">#con {top: 0px;}</code>，这样我们就可以看见：</p><p><img src="../img/in-post/2020-11-5-Do-not-Tap-The-White-Tile/uid1133717-20191017-1571294959274" alt="图片描述"></p><p>是不是很像别踩白块的界面了呢，我们已经成功了一大步，然后就是通过 js 来实现动态的插入黑块或白块，以及操作。</p><h4 id="游戏初始化">游戏初始化</h4><p>根据前面的 HTML 部分我们可以知道，每个 <code class="language-plaintext highlighter-rouge">&lt;div class="cell"&gt;</code> 就代表一个白块，<code class="language-plaintext highlighter-rouge">&lt;div class="cell black"&gt;</code> 就代表一个黑块，每点击一个黑块消失其实是删除了一个 <code class="language-plaintext highlighter-rouge">&lt;div class="row"&gt;</code> 然后从上面添加一个新的 <code class="language-plaintext highlighter-rouge">&lt;div class="row"&gt;</code> 所以我们首先要通过 js 来控制 <code class="language-plaintext highlighter-rouge">&lt;div class="row"&gt;</code> 的创造和生成（记得删除在编写静态页面时候指定生成的 4 个 <code class="language-plaintext highlighter-rouge">div.row</code>）。具体方法如下：</p><p>删除之前写的 4 个 div.row，将 index.html 文件改为以下代码：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;title&gt;</span>别踩白块<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/index.css"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h2&gt;</span>score<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">"score"</span><span class="nt">&gt;</span>0<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"main"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"con"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"btn"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"start"</span> <span class="na">onclick=</span><span class="s">"start()"</span><span class="nt">&gt;</span>
        开始游戏
      <span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/index.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>对游戏进行初始化，在 <code class="language-plaintext highlighter-rouge">js/index.js</code> 文件中写入以下代码：</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="c1">// 创建div, className是其类名</span>
<span class="kd">function</span> <span class="nx">creatediv</span><span class="p">(</span><span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">div</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">className</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">div</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 创造一个&lt;div class="row"&gt;并且有四个子节点&lt;div class="cell"&gt;</span>
<span class="kd">function</span> <span class="nx">createrow</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">con</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="nx">creatediv</span><span class="p">(</span><span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">);</span> <span class="c1">//创建div className=row</span>
  <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">creatcell</span><span class="p">();</span> <span class="c1">//定义div cell的类名,其中一个为cell black</span>

  <span class="nx">con</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span> <span class="c1">// 添加row为con的子节点</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">row</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">creatediv</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span> <span class="c1">//添加row的子节点 cell</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">con</span><span class="p">.</span><span class="nx">firstChild</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">con</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">con</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">con</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//删除div#con的子节点中最后那个&lt;div class="row"&gt;</span>
<span class="kd">function</span> <span class="nx">delrow</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">con</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">con</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">con</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">con</span><span class="p">.</span><span class="nx">lastChild</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 创建一个类名的数组，其中一个为cell black, 其余为cell</span>
<span class="kd">function</span> <span class="nx">creatcell</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temp</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">];</span>
  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">//随机产生黑块的位置 Math.random()函数参数 0~1的随机数</span>
  <span class="nx">temp</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">cell black</span><span class="dl">'</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">temp</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><h4 id="让黑块动起来">让黑块动起来</h4><p>在可以通过 js 来创造和销毁 <code class="language-plaintext highlighter-rouge">div</code> 后，我们就要让黑块动起来，这个时候我们就用到了之前 css 提到的设定 <code class="language-plaintext highlighter-rouge">&lt;div id="con"&gt;</code> 隐藏了一行的 <code class="language-plaintext highlighter-rouge">&lt;div id="row"&gt;</code>，我们通过 js 的 DOM 操作使其向下方移动，并设置定时器每 30 毫秒移动一次，这样就实现了黑块的平滑移动，在黑块移动的同时，我们要判断黑块是否已经触底，触底则游戏失败，停止调用 <code class="language-plaintext highlighter-rouge">move()</code>，触底后调用函数 <code class="language-plaintext highlighter-rouge">fail()</code> 游戏失败，具体方法如下：</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="c1">//让黑块动起来</span>
<span class="kd">function</span> <span class="nx">move</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">con</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">con</span><span class="p">,</span> <span class="kc">null</span><span class="p">)[</span><span class="dl">'</span><span class="s1">top</span><span class="dl">'</span><span class="p">]);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">speed</span> <span class="o">+</span> <span class="nx">top</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">top</span> <span class="o">+=</span> <span class="nx">speed</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">con</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="nx">top</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">px</span><span class="dl">'</span><span class="p">;</span> <span class="c1">//不断移动top值，使它动起来</span>
  <span class="nx">over</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">top</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">createrow</span><span class="p">();</span>
    <span class="nx">con</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">-102px</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">delrow</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 加速函数</span>
<span class="kd">function</span> <span class="nx">speedup</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">speed</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">speed</span> <span class="o">==</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">你超神了</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 判断游戏是否结束</span>

<span class="kd">function</span> <span class="nx">over</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">con</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">pass</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fail</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">rows</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">pass1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">fail</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 游戏结束</span>
<span class="kd">function</span> <span class="nx">fail</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">clock</span><span class="p">);</span>
  <span class="nx">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="nx">confirm</span><span class="p">(</span><span class="dl">'</span><span class="s1">你的最终得分为 </span><span class="dl">'</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">score</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">con</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">con</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
  <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">score</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">con</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">-408px</span><span class="dl">'</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><h4 id="点击黑块事件">点击黑块事件</h4><p>让黑块动起来之后呢，我们就来考虑怎么判断用户有没有点击到黑块呢，同时用户若点击到黑块，我们要让所在那一行消失，那么我们需要一个 <code class="language-plaintext highlighter-rouge">judge</code> 方法，具体如下：</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="c1">// 判断是否点击黑块、白块</span>
<span class="kd">function</span> <span class="nx">judge</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">pass1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//定义属性pass，表示此行row的白块已经被点击</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//点击目标元素 类名中包含 black 说明是黑块</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">pass</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//定义属性pass，表明此行row的黑块已经被点击</span>
    <span class="nx">score</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>其实程序写到这里，几个核心的功能点都已经实现了，是不是感觉很简单呢。剩下来的就是将这些方法组合起来，组成完整的逻辑关系，在我给出的源码里添加有一个记分器记录用户分数的功能，同时设置加速方法，使黑块的移动越来越快等等。有兴趣的的同学可以尝试着添加事件按钮，使这个游戏更接近 APP 版本。</p><h4 id="js-完整代码">js 完整代码</h4><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
</pre></td><td class="rouge-code"><pre><span class="c1">// 工具封装</span>
<span class="c1">// 根据id来获取元素</span>
<span class="kd">function</span> <span class="nx">$</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 创建div, className是其类名</span>
<span class="kd">function</span> <span class="nx">creatediv</span><span class="p">(</span><span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">div</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">className</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">div</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">clock</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">speed</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="c1">//点击开始游戏按钮 开始游戏</span>
<span class="kd">function</span> <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">flag</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">init</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">游戏已经开始，无须再次点击！</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*
 *    初始化 init
 */</span>
<span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">createrow</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// 添加onclick事件</span>
  <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ev</span> <span class="o">=</span> <span class="nx">ev</span> <span class="o">||</span> <span class="nx">event</span><span class="p">;</span>
    <span class="nx">judge</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// 定时器 每30毫秒调用一次move()</span>
  <span class="nx">clock</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">setInterval</span><span class="p">(</span><span class="dl">'</span><span class="s1">move()</span><span class="dl">'</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 判断是否点击黑块、白块</span>
<span class="kd">function</span> <span class="nx">judge</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">pass1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//定义属性pass，表示此行row的白块已经被点击</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//点击目标元素 类名中包含 black 说明是黑块</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">pass</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//定义属性pass，表明此行row的黑块已经被点击</span>
    <span class="nx">score</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 判断游戏是否结束</span>

<span class="kd">function</span> <span class="nx">over</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">con</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">rows</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">pass</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fail</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">rows</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">pass1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">fail</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 游戏结束</span>
<span class="kd">function</span> <span class="nx">fail</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">clock</span><span class="p">);</span>
  <span class="nx">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="nx">confirm</span><span class="p">(</span><span class="dl">'</span><span class="s1">你的最终得分为 </span><span class="dl">'</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">score</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">con</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">con</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
  <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">score</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">con</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">-408px</span><span class="dl">'</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 创造一个&lt;div class="row"&gt;并且有四个子节点&lt;div class="cell"&gt;</span>
<span class="kd">function</span> <span class="nx">createrow</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">con</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="nx">creatediv</span><span class="p">(</span><span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">);</span> <span class="c1">//创建div className=row</span>
  <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">creatcell</span><span class="p">();</span> <span class="c1">//定义div cell的类名,其中一个为cell black</span>

  <span class="nx">con</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span> <span class="c1">// 添加row为con的子节点</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">row</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">creatediv</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span> <span class="c1">//添加row的子节点 cell</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">con</span><span class="p">.</span><span class="nx">firstChild</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">con</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">con</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">con</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 创建一个类名的数组，其中一个为cell black, 其余为cell</span>
<span class="kd">function</span> <span class="nx">creatcell</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temp</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cell</span><span class="dl">'</span><span class="p">];</span>
  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">//随机产生黑块的位置 Math.random()函数参数 0~1的随机数</span>
  <span class="nx">temp</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">cell black</span><span class="dl">'</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">temp</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//让黑块动起来</span>
<span class="kd">function</span> <span class="nx">move</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">con</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">con</span><span class="p">,</span> <span class="kc">null</span><span class="p">)[</span><span class="dl">'</span><span class="s1">top</span><span class="dl">'</span><span class="p">]);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">speed</span> <span class="o">+</span> <span class="nx">top</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">top</span> <span class="o">+=</span> <span class="nx">speed</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">con</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="nx">top</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">px</span><span class="dl">'</span><span class="p">;</span> <span class="c1">//不断移动top值，使它动起来</span>
  <span class="nx">over</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">top</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">createrow</span><span class="p">();</span>
    <span class="nx">con</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">-102px</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">delrow</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 加速函数</span>
<span class="kd">function</span> <span class="nx">speedup</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">speed</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">speed</span> <span class="o">==</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">你超神了</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//删除某行</span>
<span class="kd">function</span> <span class="nx">delrow</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">con</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">con</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">con</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">con</span><span class="p">.</span><span class="nx">lastChild</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 记分</span>
<span class="kd">function</span> <span class="nx">score</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">newscore</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">score</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//分数加一</span>
  <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">score</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">newscore</span><span class="p">;</span> <span class="c1">//修改分数</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">newscore</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//当分数是10 的倍数时使用加速函数，越来越快</span>
    <span class="nx">speedup</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><h1 id="总结">总结</h1><p>仅仅一百多行代码我们就实现了一个简单有趣的 Web 小游戏。如果你刚入门前端，相信本项目可以很好的让你理解，练习如何使用 JavaScript 操作 DOM.</p><hr style="visibility:hidden"><ul class="pager"><li class="previous"><a href="/h5-ping-tu-1.html" data-toggle="tooltip" data-placement="top" title="h5拼图小游戏">Previous<br><span>h5拼图小游戏</span></a></li></ul><hr style="visibility:hidden"><div id="disqus_comment" class="comment"><div id="disqus_thread" class="disqus-thread"></div></div></div><div class="col-lg-2 col-lg-offset-0 visible-lg-block sidebar-container catalog-container"><div class="side-catalog"><hr class="hidden-sm hidden-xs"><h5><a class="catalog-toggle" href="#">CATALOG</a></h5><ul class="catalog-body"></ul></div></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 sidebar-container"><div class="dropdown navbar-form navbar-right"><input id="search-input" name="word" type="text" aria-haspopup="true" aria-expanded="false" data-toggle="dropdown" class="form-control typeahead" placeholder="搜索"><ul class="dropdown-menu" aria-labelledby="dLabel" id="results-container"></ul></div><script src="/js/simple-jekyll-search.js" type="text/javascript"></script><script>window.simpleJekyllSearch=new SimpleJekyllSearch({searchInput:document.getElementById("search-input"),resultsContainer:document.getElementById("results-container"),json:"/search.json",searchResultTemplate:'<li><a href="{url}" title="{desc}">{title}</a></li>',noResultsText:"没有搜索到文章",limit:20,fuzzy:!0})</script><section><hr class="hidden-sm hidden-xs"><h5><a href="/archive/">FEATURED TAGS</a></h5><div class="tags"><a data-sort="0023" href="/archive/?tag=Linux" title="Linux" rel="3">Linux</a> <a data-sort="0018" href="/archive/?tag=cpp" title="cpp" rel="8">cpp</a> <a data-sort="0020" href="/archive/?tag=%E5%90%8E%E7%AB%AF" title="后端" rel="6">后端</a> <a data-sort="0020" href="/archive/?tag=%E7%AE%97%E6%B3%95" title="算法" rel="6">算法</a> <a data-sort="0022" href="/archive/?tag=%E6%80%A7%E8%83%BD" title="性能" rel="4">性能</a> <a data-sort="0022" href="/archive/?tag=%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" title="数据结构" rel="4">数据结构</a> <a data-sort="0022" href="/archive/?tag=mysql" title="mysql" rel="4">mysql</a> <a data-sort="0024" href="/archive/?tag=%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8" title="信息安全" rel="2">信息安全</a> <a data-sort="0024" href="/archive/?tag=%E5%89%8D%E7%AB%AF" title="前端" rel="2">前端</a> <a data-sort="0024" href="/archive/?tag=java" title="java" rel="2">java</a> <a data-sort="0024" href="/archive/?tag=kali" title="kali" rel="2">kali</a> <a data-sort="0024" href="/archive/?tag=linux" title="linux" rel="2">linux</a></div></section><hr><h5>FRIENDS</h5><ul class="list-inline"><li><a href="https://2084team.cn/">2084 Team</a></li></ul></div></div><div class="row"><div id="gitmentContainer"></div><script src="/js/gitment.browser.js"></script><link rel="stylesheet" href="/css/default.css"></div></div></article><script type="text/javascript">var disqus_shortname="donaldxy",disqus_identifier="/Do-not-Tap-The-White-Tile",disqus_url="https://czqu.cc/Do-not-Tap-The-White-Tile.html";!function(){if(is_global){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}else document.getElementById("disqus_comment").style.display="none"}()</script><script>if(is_global)document.getElementById("gitmentContainer").style.display="none";else{var gitment=new Gitment({id:"/Do-not-Tap-The-White-Tile.html",owner:"czqu",repo:"czqu.github.io",oauth:{client_id:"23a9781cae2172c5d591",client_secret:"4493f8b5c72f024f1a7b79d556b7e43599f918ed"}});gitment.render("gitmentContainer")}</script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>async("/js/anchor.min.js",function(){anchors.options={visible:"hover",placement:"right"},anchors.add().remove(".intro-header h1").remove(".subheading").remove(".sidebar-container h5")})</script><style>@media all and (min-width:800px){.anchorjs-link{position:absolute;left:-.75em;font-size:1.1em;margin-top:-.1em}}</style><footer><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a id="rss" href="/feed.xml"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-rss fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="https://www.zhihu.com/people/czqu"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">知</i></span></a></li><li><a target="_blank" href="https://blog.csdn.net/weixin_44409903"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">C</i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; Czq's Blog 2020<br><a id="switchsite" href="https://blog.xiyuan.ren/">国内访问</a> &nbsp; &nbsp;&nbsp; <a href="/license.html">许可协议 License</a><br><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv">&nbsp;本站总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;次&nbsp;</span><span id="busuanzi_container_site_uv"> &nbsp;访客数&nbsp;<span id="busuanzi_value_site_uv"></span>&nbsp;人次</span><script type="text/javascript">var linkobj=document.getElementById("switchsite");current_url=window.location.href,is_global?(target_url=replacedomain(current_url,document.domain,"blog.czqu.ren"),linkobj.href=target_url,linkobj.innerText="国内访问"):(target_url=replacedomain(current_url,document.domain,"czqu.cc"),linkobj.href=target_url,linkobj.innerText="海外访问")</script></p></div></div></div></footer><script src="/js/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/hux-blog.min.js"></script><script src="/js/snackbar.js"></script><script src="/js/sw-registration.js"></script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>async("/js/fastclick.min.js",function(){var c=document.querySelector("nav");c&&FastClick.attach(c)})</script><script>var _gaId="UA-171260366-1",_gaDomain="czqu.cc";_gaDomain=is_global?(_gaId="UA-171260366-1","czqu.cc"):(_gaId="UA-171260366-2","blog.czqu.ren"),function(a,e,g,c,n,o,t){a.GoogleAnalyticsObject=n,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,o=e.createElement(g),t=e.getElementsByTagName(g)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",t.parentNode.insertBefore(o,t)}(window,document,"script",0,"ga"),ga("create",_gaId,_gaDomain),ga("send","pageview")</script><script>var _baId="202567f05f85026a62a117eec19b4a09",linkobj=document.getElementById("switchsite");_baId=is_global?"202567f05f85026a62a117eec19b4a09":"496677e3ceac55257d74003c6c3c2f3b";var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?"+_baId;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(e,a)}()</script><script type="text/javascript">function generateCatalog(e){var a,l,n,t,o,c;return _containerSelector="div.post-container",a=$(_containerSelector).find("h1,h2,h3,h4,h5,h6"),$(e).html(""),a.each(function(){l=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),c=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),t=$('<li class="'+l+'_nav"></li>').append(c),$(e).append(t)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),async("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><img src="/img/icon_wechat.png" width="0" height="0"></body></html>